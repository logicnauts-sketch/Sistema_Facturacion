{% extends "home.html" %}

{% block title %}Control de Ventas - Productos{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
    <link rel="stylesheet" href="/static/css/controlventas.css">
{% endblock %}

{% block content %}
    <div class="containerv">
        <!-- Header -->
        <header class="header">
            <div class="header-titles">
                <h1>Control de Ventas - Productos</h1>
                <p>Dashboard de análisis y reportes</p>
            </div>
            
            <div class="period-filters">
                <h2><i class="fas fa-calendar-alt"></i> Filtros de Período</h2>
                <div class="period-buttons">
                    <button class="period-btn active" data-period="hoy">
                        <i class="fas fa-calendar-day"></i> Hoy
                    </button>
                    <button class="period-btn" data-period="semana">
                        <i class="fas fa-calendar-week"></i> Esta semana
                    </button>
                    <button class="period-btn" data-period="mes">
                        <i class="fas fa-calendar"></i> Este mes
                    </button>
                    <button class="period-btn" data-period="año">
                        <i class="fas fa-calendar-check"></i> Este año
                    </button>
                    <button class="period-btn" data-period="personalizado">
                        <i class="fas fa-calendar-plus"></i> Rango personalizado
                    </button>
                </div>
            </div>
            
            <div class="header-controls">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Buscar producto..." id="searchInput">
                </div>
                <button class="filter-btn" id="toggleFilters">
                    <i class="fas fa-filter"></i> Filtros
                </button>
                
                <!-- Panel de filtros desplegable -->
                <div class="filters-panel" id="filtersPanel">
                    <div class="filters-header">
                        <h3 class="filters-title">Filtros Avanzados</h3>
                        <button class="close-filters" id="closeFilters">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="filter-group">
                        <label for="categoryFilter"><i class="fas fa-tags"></i> Filtrar por Categoría</label>
                        <select id="categoryFilter">
                            <option value="">Todas las categorías</option>
                            <option value="Tecnología">Tecnología</option>
                            <option value="Muebles">Muebles</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="productFilter"><i class="fas fa-box"></i> Filtrar por Producto</label>
                        <select id="productFilter">
                            <option value="">Todos los productos</option>
                            <option value="Laptop HP EliteBook">Laptop HP EliteBook</option>
                            <option value="Smartphone Samsung Galaxy">Smartphone Samsung Galaxy</option>
                            <option value="Mesa de Oficina">Mesa de Oficina</option>
                            <option value="Silla Ergonómica">Silla Ergonómica</option>
                            <option value="Impresora Laser">Impresora Laser</option>
                            <option value="Monitor 24&quot;">Monitor 24"</option>
                        </select>
                    </div>
                    
                    <div class="filter-actions">
                        <button class="apply-btn" id="applyFilters">Aplicar Filtros</button>
                        <button class="reset-btn" id="resetFilters">Restablecer</button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Metrics -->
        <div class="metrics">
            <div class="metric-card">
                <div class="metric-icon">
                    <i class="fas fa-shopping-cart"></i>
                </div>
                <div class="metric-info">
                    <div class="metric-title">Ventas Totales</div>
                    <div id="totalSales" class="metric-value">$0.00</div>
                    <div class="metric-trend">
                        <i class="fas fa-arrow-up"></i> Cargando...
                    </div>
                </div>
            </div>
            
            <div class="metric-card secondary">
                <div class="metric-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="metric-info">
                    <div class="metric-title">Promedio por Venta</div>
                    <div id="avgSale" class="metric-value">$0.00</div>
                    <div class="metric-trend">
                        <i class="fas fa-arrow-up"></i> Cargando...
                    </div>
                </div>
            </div>
            
            <div class="metric-card accent">
                <div class="metric-icon">
                    <i class="fas fa-box"></i>
                </div>
                <div class="metric-info">
                    <div class="metric-title">Productos Vendidos</div>
                    <div id="productsSold" class="metric-value">0</div>
                    <div class="metric-trend">
                        Cargando...
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Table -->
        <div class="table-container">
            <div class="table-header">
                <h2 class="table-title">Detalle de Ventas por Producto</h2>
                <div class="table-actions">
                    <button class="export-btn" id="exportExcel">
                        <i class="fas fa-file-excel"></i> Exportar Excel
                    </button>
                    <button class="export-btn" id="exportPDF">
                        <i class="fas fa-file-pdf"></i> Exportar PDF
                    </button>
                </div>
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th class="sortable" data-sort="product">
                            <span>Producto</span>
                            <i class="fas fa-sort sort-icon"></i>
                        </th>
                        <th class="sortable" data-sort="category">
                            <span>Categoría</span>
                            <i class="fas fa-sort sort-icon"></i>
                        </th>
                        <th class="sortable" data-sort="sales">
                            <span>Total Ventas</span>
                            <i class="fas fa-sort sort-icon"></i>
                        </th>
                        <th class="sortable" data-sort="quantity">
                            <span>Cantidad Vendida</span>
                            <i class="fas fa-sort sort-icon"></i>
                        </th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="productsTableBody">
                    <!-- Los datos se cargarán dinámicamente -->
                </tbody>
            </table>
            
            <div class="table-footer">
                <div class="summary">Mostrando <span id="shownItems">0</span> de <span id="totalItems">0</span> productos</div>
                <div class="pagination">
                    <button class="pagination-btn" id="prevPage"><i class="fas fa-chevron-left"></i></button>
                    <button class="pagination-btn active" id="page1">1</button>
                    <button class="pagination-btn" id="page2">2</button>
                    <button class="pagination-btn" id="page3">3</button>
                    <button class="pagination-btn" id="nextPage"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
        </div>
        
        <!-- Chart -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Ventas por Producto</h2>
                <div class="table-actions">
                    <button class="export-btn" id="refreshData">
                        <i class="fas fa-sync-alt"></i> Actualizar Datos
                    </button>
                </div>
            </div>
            <div class="chart-canvas">
                <canvas id="salesChart"></canvas>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/static/js/controlventas.js"></script>
{% endblock %}